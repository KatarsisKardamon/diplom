# Тестирование сайта Кинопоиск

Этот проект представляет собой автоматизированные тесты сайта **Кинопоиск**. Ссылка на главную страницу:  
[https://www.kinopoisk.ru/]

Тест написан на **Python** с использованием:
- `selenium` — для управления браузером
- `pytest` — для запуска тестов
- `allure` — для генерации наглядного отчёта


## Как запустить тесты и сформировать отчёт
### 1. Установите необходимые пакеты

- Убедитесь, что у вас установлен Python последней версии;
- Установите Selenium: pip install selenium;
- Установите Pytest: pip install pytest; 
- Установите Allure: pip install allure-pytest; 
- Установите Webdriver-manager: pip install Webdriver-manager.

### 2. Запустите тесты и укажите путь к каталогу результатов тестирования:

python -m pytest --alluredir allure-result

После выполнения теста в папке Allure появятся файлы с данными для отчёта.

## Как конвертировать результаты теста в отчет Allure
### 1. Установите Allure Report
Allure Report — это утилита. Она обрабатывает результаты тестирования и создает HTML-отчет.

Пользователи Windows: запустите в терминале VS Code команду:
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
Invoke-RestMethod -Uri https://get.scoop.sh | Invoke-Expression

Затем команду:
scoop install allure

Пользователи macOS: запустите в терминале VS Code команду:
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

Затем команду:
brew install allure

### 2. Сгенерируйте и откройте отчёт
Введите команду ниже — сгенерируется отчет о тестах:
allure serve allure-result

Команда соберёт HTML-отчёт из данных в папке Allure;
Запустит локальный сервер;
Автоматически откроет отчёт в браузере;

В отчёте вы увидите:

- Название и описание теста;
- Пошаговое выполнение (with allure.step);
- Статус прохождения;
- Время выполнения;
- Возможность добавить скриншоты.


## Описание тестов: test_api

### test_search_film_name_api()

Тест выполняет поиск фильма по названию.

Что делает тест:

1. Формирует URL-адрес запроса к API для поиска фильмов ({base_url}/v1.4/movie/search).
2. Задаёт параметры запроса, используя переменную ver_film_name для поиска по названию фильма (параметры: page=1, limit=10, query=<название фильма>).
3. Отправляет GET-запрос к API с заданными параметрами и заголовком X-API-KEY.
4. Проверяет, что статус-код ответа равен 200 (успешное выполнение запроса).

Особенности реализации:

1. Используется библиотека requests для отправки HTTP-запросов.
2. Для структурирования шагов теста применяются аннотации allure.step() — каждый шаг выделен отдельно в отчёте.
3. Проверка статуса ответа осуществляется через утверждение assert resp.status_code == 200.

Аннотации:

- @allure.title('Поиск фильма по названию')
- @allure.description('Проверяется статус-код 200')
- @allure.feature('READ')
- @allure.severity('critical')

Шаги в отчёте:

- Задать URL запроса.
- Задать параметры запроса с переменной ver_film_name.
- Передать GET-запрос.
- Проверить статус-код.


### test_search_actor_api()

Тест выполняет поиск актёра по имени.

Что делает тест:

1. Формирует URL-адрес запроса к API для поиска актёров ({base_url}/v1.4/person/search).
2. Задаёт параметры запроса, используя переменную ver_actor для поиска по имени актёра (параметры: page=1, limit=10, query=<имя актёра>).
3. Отправляет GET-запрос к API с заданными параметрами и заголовком X-API-KEY.
4. Проверяет, что статус-код ответа равен 200 (успешное выполнение запроса).

Особенности реализации:

Аналогичен test_search_film_name_api(), но направлен на поиск актёров, а не фильмов.
Использует те же механизмы структурирования шагов и проверки статуса ответа.

Аннотации:

- @allure.title('Поиск актёра по имени')
- @allure.description('Проверяется статус-код 200')
- @allure.feature('READ')
- @allure.severity('critical')

Шаги в отчёте:

- Задать URL запроса.
- Задать параметры запроса с переменной ver_actor.
- Передать GET-запрос.
- Проверить статус-код.


### test_search_random_api()

Тест выполняет поиск фильма по заданным фильтрам (год выпуска и сборы в России).

Что делает тест:

1. Формирует URL-адрес запроса к API для случайного поиска фильмов с фильтрами ({base_url}/v1.4/movie/random).
2. Задаёт параметры запроса с использованием переменных ver_year (год выпуска) и ver_fees_russia_value (сборы в России): notNullFields='year', year=<год>, fees.russia.value=<сумма сборов>.
3. Отправляет GET-запрос к API с заданными параметрами и заголовком X-API-KEY.
4. Проверяет, что статус-код ответа равен 200 (успешное выполнение запроса).

Особенности реализации:

Поиск осуществляется не по названию, а по фильтрам.
Проверяются возможности API по фильтрации результатов по сложным критериям.

Аннотации:

- @allure.title('Поиск фильма по фильтрам')
- @allure.description('Проверяется статус-код 200')
- @allure.feature('READ')
- @allure.severity('normal')

Шаги в отчёте:

- Задать URL запроса.
- Задать параметры запроса с переменными ver_year, ver_fees_russia_value.
- Передать GET-запрос.
- Проверить статус-код.


### test_negativ_search_random_api()

Тест проверяет обработку некорректных параметров при поиске фильма по фильтрам (негативный сценарий).

Что делает тест:

1. Формирует URL-адрес запроса к API для случайного поиска фильмов с фильтрами ({base_url}/v1.4/movie/random).
2. Задаёт параметры запроса с некорректным значением года (neg_ver_year) и корректным значением сборов (ver_fees_russia_value): notNullFields='year', year=<некорректный год>, fees.russia.value=<сумма сборов>.
3. Отправляет GET-запрос к API с заданными параметрами и заголовком X-API-KEY.
4. Проверяет, что статус-код ответа равен 400 (ошибка клиента, некорректные параметры).

Особенности реализации:

Тестируется обработка ошибок API при передаче некорректных данных.
Ожидается ошибка 400.

Аннотации:

- @allure.title('Поиск фильма по фильтрам (негативный)')
- @allure.description('Проверяется статус-код 400')
- @allure.feature('READ')
- @allure.severity('normal')

Шаги в отчёте:

- Задать URL запроса.
- Задать параметры запроса с переменными neg_ver_year, ver_fees_russia_value.
- Передать GET-запрос.
- Проверить статус-код (ожидается 400).

### test_negativ_search_actor_api()

Тест проверяет обработку отсутствия заголовка X-API-KEY при поиске актёра по имени (негативный сценарий).

Что делает тест:

1. Формирует URL-адрес запроса к API для поиска актёров ({base_url}/v1.4/person/search).
2. Задаёт параметры запроса, используя переменную ver_actor для поиска по имени актёра (параметры: page=1, limit=10, query=<имя актёра>).
3. Отправляет GET-запрос к API без заголовка X-API-KEY (имитация отсутствия токена).
4. Проверяет, что статус-код ответа равен 401 (неавторизованный доступ).

Особенности реализации:

Тестируется механизм аутентификации API.
Отсутствие токена приводит к ожидаемой ошибке 401, что подтверждает работу системы защиты API.

Аннотации:

- @allure.title('Поиск актёра по имени (негативный)')
- @allure.description('Проверяется статус-код 401')
- @allure.feature('READ')
- @allure.severity('normal')

Шаги в отчёте:

- Задать URL запроса.
- Задать параметры запроса с переменной ver_actor.
- Передать GET-запрос без Headers (X-API-KEY).
- Проверить статус-код (ожидается 401).


## Описание тестов: test_ui

### test_search_film_name(driver)

Тест выполняет поиск фильма по названию.

Что делает тест:

1. Открывает главную страницу сайта Kinopoisk.ru (https://www.kinopoisk.ru/).
2. Вводит в поле поиска (атрибут name="kp_query") название фильма, используя переменную ver_film_name.
3. Проверяет, что в «шторке» поиска (выпадающем списке результатов) отображается элемент с ID suggest-item-film-5148793, соответствующий искомому фильму.
4. Убеждается, что элемент виден на странице (метод is_displayed()).

Особенности реализации:

Используется веб-драйвер Chrome для автоматизации действий в браузере.
Применяется неявное ожидание (implicitly_wait(30)) для ввода капчи.
Окно браузера максимально развёрнуто (maximize_window()) для корректного отображения элементов.
Проверка осуществляется через поиск элемента по ID и анализ его состояния.

Аннотации:

- @allure.title('Поиск фильма по названию')
- @allure.description('Проверяется отображение названия фильма в шторке поиска')
- @allure.feature('READ')
- @allure.severity('critical')

Шаги в отчёте:

- Открыть главную страницу сайта.
- Ввести в поле поиска название фильма.
- Проверить отображение названия фильма в шторке поиска.


### test_film_page(driver)

Тест проверяет переход на страницу фильма и отображение его названия в заголовке.

Что делает тест:

1. Открывает главную страницу Kinopoisk.ru.
2. Вводит в поле поиска название фильма (ver_film_name).
3. Кликает по первому фильму в «шторке» поиска (элемент с ID suggest-item-film-5148793).
4. Переходит на страницу фильма.
5. Проверяет, что в заголовке страницы отображается название фильма («Авиатор (2025)»), используя CSS-селектор span[data-tid='75209b22'].

Особенности реализации:

Тест имитирует действия пользователя: ввод запроса, выбор результата, переход на страницу.
Используются разные методы поиска элементов (By.NAME, By.ID, By.CSS_SELECTOR).
Проверка текста элемента осуществляется через свойство text.

Аннотации:

- @allure.title('Переход на страницу фильма')
- @allure.description('Проверяется отображение названия фильма в заголовке на странице фильма')
- @allure.feature('READ')
- @allure.severity('normal')

Шаги в отчёте:

- Открыть главную страницу сайта.
- Ввести в поле поиска название фильма.
- Кликнуть по первому фильму в шторке поиска.
- Проверить название фильма в заголовке страницы.


### test_search_actor(driver)

Тест выполняет поиск актёра по имени.

Что делает тест:

1. Открывает главную страницу Kinopoisk.ru.
2. Вводит в поле поиска имя актёра, используя переменную ver_actor.
3. Проверяет, что в «шторке» поиска отображается элемент с ID suggest-item-person-39984, соответствующий искомому актёру.
4. Убеждается, что элемент виден на странице (метод is_displayed()).

Особенности реализации:

Аналогичен тесту поиска фильма, но направлен на поиск актёров.
Использует тот же механизм работы с «шторкой» поиска и проверкой видимости элемента.

Аннотации:

- @allure.title('Поиск актера по имени')
- @allure.description('Проверяется отображение имени актера в шторке поиска')
- @allure.feature('READ')
- @allure.severity('critical')

Шаги в отчёте:

- Открыть главную страницу сайта.
- Ввести в поле поиска имя актёра.
- Проверить отображение имени актёра в шторке поиска.


### test_actor_page(driver)

Тест проверяет переход на страницу актёра и отображение его имени в заголовке.

Что делает тест:

1. Открывает главную страницу Kinopoisk.ru.
2. Вводит в поле поиска имя актёра (ver_actor).
3. Кликает по первому результату в «шторке» поиска (элемент с ID suggest-item-film-5148793 — вероятно, ошибка в тесте, должен быть элемент для актёров).
4. Переходит на страницу актёра.
5. Проверяет, что в заголовке страницы отображается имя актёра («Том Харди»), используя класс элемента styles_primaryName__LB_CC.

Особенности реализации:

Имитирует пользовательские действия: ввод запроса, выбор результата, переход на страницу.
Проверка имени актёра осуществляется через текст элемента.

Аннотации:

- @allure.title('Переход на страницу актера')
- @allure.description('Проверяется отображение имени актера в заголовке на странице актера')
- @allure.feature('READ')
- @allure.severity('normal')

Шаги в отчёте:

- Открыть главную страницу сайта.
- Ввести в поле поиска имя актёра.
- Кликнуть по первому актёру в шторке поиска.
- Проверить имя актёра в заголовке страницы.


### test_negativ_name(driver)

Тест проверяет обработку несуществующего названия фильма — проверяет отображение сообщения об отсутствии результатов.

Что делает тест:

1. Открывает главную страницу Kinopoisk.ru.
2. Вводит в поле поиска несуществующее название фильма, используя переменную neg_name.
3. Проверяет, что в «шторке» поиска отображается сообщение «По вашему запросу ничего не найдено».
4. Использует класс элемента styles_emptySuggest__VnEa2 для поиска сообщения об ошибке.

Особенности реализации:

Тестирует негативный сценарий: ввод некорректного запроса.
Проверяет логику обработки ошибок на стороне интерфейса — отображение соответствующего сообщения.
Демонстрирует работу с элементами, отображаемыми при отсутствии результатов поиска.

Аннотации:

- @allure.title('Поиск фильма по несуществующему имени')
- @allure.description('Проверяется отображение текста в шторке поиска "По вашему запросу ничего не найдено"')
- @allure.feature('READ')
- @allure.severity('normal')

Шаги в отчёте:

- Открыть главную страницу сайта.
- Ввести в поле поиска несуществующее название фильма.
- Проверить отображение текста «По вашему запросу ничего не найдено» в шторке поиска.
